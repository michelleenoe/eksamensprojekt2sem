---
import Mainlayout from "../../layouts/Mainlayout.astro";

export async function getStaticPaths() {
    const data = await fetch(
    "https://uiovvvgmjftrkbiogyqx.supabase.co/rest/v1/products",
    {
      method: "GET",
      headers: {
        apikey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVpb3Z2dmdtamZ0cmtiaW9neXF4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDExMTU1MzUsImV4cCI6MjAxNjY5MTUzNX0.K1gnnZYV5aWSc4jzhiX1H2-WIcr2JXnmrj1BylbJRf0", // Replace with your actual API key
      },
    }
  ).then((response) => response.json());

  console.log("Data from API:", data);

  return data.map((product) => {
    return {
      params: { slug: String(product.slug) }, 
      props: { myData:product },
    };
  });
}

const { myData } = Astro.props;
console.log("myData in component:", myData);
---

<Mainlayout title= {myData.brand}>
  <section>
    <article>
    <a class="backbtn" href="/listeview/">BACK</a>
    <img src={myData.images} alt="Produktskud" />
      <h2>{myData.price}</h2>
      <div class="info" set:html={myData.brand} />
    </article>
  </section>
</Mainlayout>
